<section class="lens-details-section">
  @if (selectedLenses().length > 0) {
    <!-- Multiple lens details -->
    <div class="lens-details">
      <div class="specifications">
        <div class="spec-header-controls">
          <h3>Specifications ({{ selectedLenses().length }} lens{{ selectedLenses().length > 1 ? 'es' : '' }} selected)</h3>
          <div class="controls-row">
            <label class="max-mag-filter">
              <input 
                type="checkbox" 
                [(ngModel)]="showMaxMagOnly"
                class="filter-checkbox">
              Show Max Magnification Only
            </label>
            @if (availableTeleconverters().length > 0) {
              <div class="teleconverter-controls">
                <span class="control-label">Teleconverters:</span>
                @for (tc of availableTeleconverters(); track tc) {
                  <label class="teleconverter-filter">
                    <input 
                      type="checkbox" 
                      [checked]="isTeleconverterSelected(tc)"
                      (change)="toggleTeleconverter(tc)"
                      class="filter-checkbox">
                    {{ tc }}×
                  </label>
                }
              </div>
            }
          </div>
        </div>
        <div class="spec-table">
          <div class="spec-header">
            <div>Manufacturer</div>
            <div>Model</div>
            <div>TC</div>
            <div class="sortable" (click)="sortBy('focalLength')">
              Focal Length {{ getSortIcon('focalLength') }}
            </div>
            <div class="sortable" (click)="sortBy('aperture')">
              Max Aperture {{ getSortIcon('aperture') }}
            </div>
            <div class="sortable" (click)="sortBy('minFocus')">
              Min Focus {{ getSortIcon('minFocus') }}
            </div>
            <div class="sortable" (click)="sortBy('magnification')">
              Magnification {{ getSortIcon('magnification') }}
            </div>
          </div>
          @for (item of sortedLensData(); track item.lens.id + '_' + item.data.focalLength + '_' + (item.teleconverter || 'base')) {
            <div class="spec-row">
              <div class="spec-data">
                <span class="mobile-label">Manufacturer:</span>
                {{ item.lens.manufacturer }}
              </div> 
              <div class="spec-data">
                <span class="mobile-label">Model:</span>
                {{ item.lens.model }}
              </div>
              <div class="spec-data">
                <span class="mobile-label">TC:</span>
                {{ item.teleconverter ? (item.teleconverter | number:'1.1-1') + '×' : '—' }}
              </div>
              <div class="spec-data">
                <span class="mobile-label">Focal Length:</span>
                {{ item.data.focalLength | number:'1.0-0' }}mm
              </div>
              <div class="spec-data">
                <span class="mobile-label">Max Aperture:</span>
                f/{{ item.data.aperture.toFixed(1) }}
              </div>
              <div class="spec-data">
                <span class="mobile-label">Min Focus:</span>
                {{ item.data.minFocus.toFixed(2) }}m
              </div>
              <div class="spec-data">
                <span class="mobile-label">Magnification:</span>
                {{ item.data.magnification | number:'1.2-2' }}×
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  } @else {
    <div class="no-selection">
      <div class="placeholder">
        <h3>Select one or more lenses</h3>
      </div>
    </div>
  }
</section>
